{"ast":null,"code":"import _regeneratorRuntime from \"/home/server/Escritorio/frontend/node_modules/@babel/runtime/regenerator\";\nimport _slicedToArray from \"/home/server/Escritorio/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/server/Escritorio/frontend/src/componets/commons/auth/auth-context.js\";\nimport React, { useState, useContext } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { login } from \"../../axios/login\";\nimport { register } from \"../../axios/register\"; // 1) Creamos el contexto\n\nvar AuthContext = React.createContext(); // Recuperamos el token del localStorage ya que si el usuario\n// refresca la página del navegador necesito iniciar la aplicación\n// con un estado autenticado\n\nvar currentUser = JSON.parse(localStorage.getItem(\"currentUser\")); // 2) Creamos el custom Provider\n\nexport function AuthProvider(_ref) {\n  var children = _ref.children;\n\n  // 2.1) Creamos Estados\n  // En caso de que trabaje con roles deberia decodificar el token para obtener el role inicial\n  // const [role, setRole] = useState(decodeTokenAndGetRole(currentUser.token));\n  var _useState = useState(currentUser !== null),\n      _useState2 = _slicedToArray(_useState, 2),\n      isAuthenticated = _useState2[0],\n      setIsAuthenticated = _useState2[1];\n\n  var _useState3 = useState(currentUser && currentUser.user),\n      _useState4 = _slicedToArray(_useState3, 2),\n      user = _useState4[0],\n      setUser = _useState4[1];\n\n  var history = useHistory(); // 2.2) Definiremos los métodos para modificar el estado\n  // Login => Cambiaré a true mi estado\n  // Si trabajo con roles puedo establecer el role a través de la decodificación del token\n\n  var singIN = function singIN(_ref2) {\n    var firstName, lastName, email, password, gender, dob, address, postalCode, phone, bornIn;\n    return _regeneratorRuntime.async(function singIN$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            firstName = _ref2.firstName, lastName = _ref2.lastName, email = _ref2.email, password = _ref2.password, gender = _ref2.gender, dob = _ref2.dob, address = _ref2.address, postalCode = _ref2.postalCode, phone = _ref2.phone, bornIn = _ref2.bornIn;\n            _context.prev = 1;\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(register({\n              firstName: firstName,\n              lastName: lastName,\n              email: email,\n              password: password,\n              gender: gender,\n              dob: dob,\n              address: address,\n              postalCode: postalCode,\n              phone: phone,\n              bornIn: bornIn\n            }));\n\n          case 4:\n            _context.next = 9;\n            break;\n\n          case 6:\n            _context.prev = 6;\n            _context.t0 = _context[\"catch\"](1);\n            return _context.abrupt(\"return\", Promise.reject(_context.t0));\n\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[1, 6]]);\n  }; // Register => Cambiaré a true mi estado\n\n\n  var signUp = function signUp(_ref3) {\n    var firstName, lastName, email, password, gender, dob, address, postalCode, phone, bornIn;\n    return _regeneratorRuntime.async(function signUp$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            firstName = _ref3.firstName, lastName = _ref3.lastName, email = _ref3.email, password = _ref3.password, gender = _ref3.gender, dob = _ref3.dob, address = _ref3.address, postalCode = _ref3.postalCode, phone = _ref3.phone, bornIn = _ref3.bornIn;\n            _context2.prev = 1;\n            _context2.next = 4;\n            return _regeneratorRuntime.awrap(register({\n              firstName: firstName,\n              lastName: lastName,\n              email: email,\n              password: password,\n              gender: gender,\n              dob: dob,\n              address: address,\n              postalCode: postalCode,\n              phone: phone,\n              bornIn: bornIn\n            }));\n\n          case 4:\n            _context2.next = 9;\n            break;\n\n          case 6:\n            _context2.prev = 6;\n            _context2.t0 = _context2[\"catch\"](1);\n            return _context2.abrupt(\"return\", Promise.reject(_context2.t0));\n\n          case 9:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[1, 6]]);\n  }; // Logout => Cambiaré a false mi estado\n\n\n  var logout = function logout() {\n    setUser(null);\n    setIsAuthenticated(false);\n    localStorage.removeItem(\"currentUser\");\n  }; // 2.3) Devolvemos el Context\n  // Si usara roles puedo devolver el role actual del usuario en lugar de isAuthenticated\n  // return (\n  //   <AuthContext.Provider\n  //     value={{ role, setRole, signIn, user }}\n  //   >\n  //     {children}\n  //   </AuthContext.Provider>\n  // );\n\n\n  return React.createElement(AuthContext.Provider, {\n    value: {\n      isAuthenticated: isAuthenticated,\n      setIsAuthenticated: setIsAuthenticated,\n      singIN: singIN,\n      user: user,\n      signUp: signUp,\n      logout: logout\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }, children);\n} // 3) Crear el custom hook\n// Es lo que usaré en los componentes para acceder al value del contexto\n\nexport function useAuth() {\n  var context = useContext(AuthContext);\n  return context;\n}","map":{"version":3,"sources":["/home/server/Escritorio/frontend/src/componets/commons/auth/auth-context.js"],"names":["React","useState","useContext","useHistory","login","register","AuthContext","createContext","currentUser","JSON","parse","localStorage","getItem","AuthProvider","children","isAuthenticated","setIsAuthenticated","user","setUser","history","singIN","firstName","lastName","email","password","gender","dob","address","postalCode","phone","bornIn","Promise","reject","signUp","logout","removeItem","useAuth","context"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { login } from \"../../axios/login\";\nimport { register } from \"../../axios/register\";\n\n// 1) Creamos el contexto\nconst AuthContext = React.createContext();\n\n// Recuperamos el token del localStorage ya que si el usuario\n// refresca la página del navegador necesito iniciar la aplicación\n// con un estado autenticado\nconst currentUser = JSON.parse(localStorage.getItem(\"currentUser\"));\n\n// 2) Creamos el custom Provider\nexport function AuthProvider({ children }) {\n  // 2.1) Creamos Estados\n  // En caso de que trabaje con roles deberia decodificar el token para obtener el role inicial\n  // const [role, setRole] = useState(decodeTokenAndGetRole(currentUser.token));\n  const [isAuthenticated, setIsAuthenticated] = useState(currentUser !== null);\n  const [user, setUser] = useState(currentUser && currentUser.user);\n\n  const history = useHistory();\n\n  // 2.2) Definiremos los métodos para modificar el estado\n  // Login => Cambiaré a true mi estado\n  // Si trabajo con roles puedo establecer el role a través de la decodificación del token\n  const singIN = async ({\n    firstName,\n    lastName,\n    email,\n    password,\n    gender,\n    dob,\n    address,\n    postalCode,\n    phone,\n    bornIn,\n  }) => {\n    try {\n      await register({\n        firstName,\n        lastName,\n        email,\n        password,\n        gender,\n        dob,\n        address,\n        postalCode,\n        phone,\n        bornIn,\n      });\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  };\n\n  // Register => Cambiaré a true mi estado\n  const signUp = async ({\n    firstName,\n    lastName,\n    email,\n    password,\n    gender,\n    dob,\n    address,\n    postalCode,\n    phone,\n    bornIn,\n  }) => {\n    try {\n      await register({\n        firstName,\n        lastName,\n        email,\n        password,\n        gender,\n        dob,\n        address,\n        postalCode,\n        phone,\n        bornIn,\n      });\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  };\n\n  // Logout => Cambiaré a false mi estado\n  const logout = () => {\n    setUser(null);\n    setIsAuthenticated(false);\n    localStorage.removeItem(\"currentUser\");\n  };\n\n  // 2.3) Devolvemos el Context\n  // Si usara roles puedo devolver el role actual del usuario en lugar de isAuthenticated\n  // return (\n  //   <AuthContext.Provider\n  //     value={{ role, setRole, signIn, user }}\n  //   >\n  //     {children}\n  //   </AuthContext.Provider>\n  // );\n  return (\n    <AuthContext.Provider\n      value={{\n        isAuthenticated,\n        setIsAuthenticated,\n        singIN ,\n        user,\n        signUp,\n        logout\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\n// 3) Crear el custom hook\n// Es lo que usaré en los componentes para acceder al value del contexto\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  return context;\n}\n"]},"metadata":{},"sourceType":"module"}